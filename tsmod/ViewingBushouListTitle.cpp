#include "TSModCommand.h"
#include "CommonGlobalHandle.h"

#include "SetNeedKoudouryoku.h"

/*
 武将リストのタイトルが表示される時
 武将名、政治、政得、などのもの。
 */

/*
0043892B   . 8B89 D0040000  MOV     ECX, DWORD PTR DS:[ECX+4D0]
00438931   . 8B4424 04      MOV     EAX, DWORD PTR SS:[ESP+4]
00438935   . 8B0481         MOV     EAX, DWORD PTR DS:[ECX+EAX*4]
00438938   . 6BC0 0C        IMUL    EAX, EAX, 0C
0043893B   . 8B80 048F4C00  MOV     EAX, DWORD PTR DS:[EAX+4C8F04]
00438941   . C2 0400        RETN    4
*/

/*
            　┌「武将名」という文字へのポインタ
004C8F04  [F8 8E 4C 00] [0C 00 00 00] [01 00 00 00] F0 8E 4C 00
　　　     　　0x0Cという表示幅┘        └１番目
004C8F14  0A 00 00 00 02 00 00 00 B0 B8 4B 00 10 00 00 00  
004C8F24  03 00 00 00 2C B9 4B 00 0A 00 00 00 04 00 00 00  
004C8F34  E8 8E 4C 00 08 00 00 00 05 00 00 00 E0 8E 4C 00  
004C8F44  06 00 00 00 06 00 00 00 D8 8E 4C 00 04 00 00 00  
004C8F54  07 00 00 00 D0 8E 4C 00 04 00 00 00 08 00 00 00  
004C8F64  C8 8E 4C 00 04 00 00 00 09 00 00 00 C0 8E 4C 00  
004C8F74  04 00 00 00 0A 00 00 00 90 AD 4B 00 04 00 00 00  
004C8F84  0B 00 00 00 B8 8E 4C 00 04 00 00 00 0C 00 00 00  
004C8F94  B0 8E 4C 00 04 00 00 00 0D 00 00 00 4C BC 4B 00  
004C8FA4  04 00 00 00 0E 00 00 00 A8 8E 4C 00 04 00 00 00  
004C8FB4  0F 00 00 00 A0 8E 4C 00 04 00 00 00 10 00 00 00  
004C8FC4  44 BC 4B 00 04 00 00 00 11 00 00 00 98 8E 4C 00  
004C8FD4  04 00 00 00 12 00 00 00 90 8E 4C 00 04 00 00 00  
004C8FE4  13 00 00 00 3C BC 4B 00 04 00 00 00 14 00 00 00  
004C8FF4  88 8E 4C 00 04 00 00 00 15 00 00 00 80 8E 4C 00  
004C9004  04 00 00 00 16 00 00 00 78 8E 4C 00 04 00 00 00  
004C9014  17 00 00 00 0C BC 4B 00 04 00 00 00 18 00 00 00  
　　　　　　　　　　　　　　　　　　　　　　　　　 ┌兵科の文字列
004C9024  70 8E 4C 00 04 00 00 00 19 00 00 00 [34 BC 4B 00]
004C9034  [08 00 00 00] 1A 00 00 00 2C BC 4B 00 04 00 00 00
　　　　　　　　└表示幅
004C9044  1B 00 00 00 24 BC 4B 00 04 00 00 00 1C 00 00 00  
004C9054  1C BC 4B 00 04 00 00 00 1D 00 00 00 14 BC 4B 00  
004C9064  04 00 00 00 1E 00 00 00 EC BB 4B 00 04 00 00 00  
004C9074  1F 00 00 00 E4 BB 4B 00 04 00 00 00 20 00 00 00  

            ┌「騎鉄」という文字へのポインタ
004C9084  [68 8E 4C 00] [04 00 00 00] 21 00 00 00 84 B4 4B 00 
　　　　　　　　　     　　　└表示幅
004C9094  04 00 00 00 22 00 00 00 64 B4 4B 00 04 00 00 00 
004C90A4  23 00 00 00 DC BB 4B 00 04 00 00 00 24 00 00 00 
004C90B4  5C B4 4B 00 04 00 00 00 25 00 00 00 D4 BB 4B 00 
004C90C4  04 00 00 00 26 00 00 00 60 8E 4C 00 04 00 00 00 
004C90D4  27 00 00 00 CC BB 4B 00 04 00 00 00 28 00 00 00 
004C90E4  54 B4 4B 00 04 00 00 00 29 00 00 00 58 8E 4C 00 
004C90F4  04 00 00 00 2A 00 00 00 50 8E 4C 00 04 00 00 00 
004C9104  2B 00 00 00                                     
*/

// 武将リスト時のタイトルの文字列や幅を変更する。
char szStringSpecialHeitai[] = "特殊兵態";
void InitModifyBushouListTitle() {

	// 上述コメントの「騎鉄」の文字列のポインタを「特殊兵態」を指すものとする。
	int iAdress = (int)szStringSpecialHeitai;
	WriteProcessMemory( CommonGlobalHandle::curProcess, (LPVOID)(0x4C9084), &iAdress, 4, NULL);

	// 幅を10バイト(全角5文字分)に書き換える。
	int iKitetsuWidth=0xA;
	WriteProcessMemory( CommonGlobalHandle::curProcess, (LPVOID)(0x4C9088), &iKitetsuWidth, 4, NULL);

}